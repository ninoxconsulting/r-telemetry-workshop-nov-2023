<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Using R for Wildlife Telemetry Data Analysis - Introduction to Telemetry Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Using R for Wildlife Telemetry Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./00-intro-setup.html" rel="" target="" aria-current="page">
 <span class="menu-text">Setup instructions</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ninoxconsulting/r-telemetry-workshop-nov-2023" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00-intro-setup.html">Intro to Telemetry Data and Visualization</a></li><li class="breadcrumb-item"><a href="./03-intro-telemetry-data.html">Introduction to Telemetry Data</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Intro to Telemetry Data and Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction and System Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro-motivation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction and Motivation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-intro-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Spatial Data with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-intro-telemetry-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction to Telemetry Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-spatial-data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of Spatial Data</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Telemetry Analysis and Covariate Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-vector-bcdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting B.C. Open Data with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-raster-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploring Raster Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-processing-vector-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing Base Vector Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-rsf-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generate random sample points for RSF</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Bonus content</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bonus-kde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generating Kernel Density Estimates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bonus-interactive-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactive maps with Leaflet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bonus-movebank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Downloading telemetry data from Movebank</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#how-to-qa-and-summarize-telemetry-data" id="toc-how-to-qa-and-summarize-telemetry-data" class="nav-link active" data-scroll-target="#how-to-qa-and-summarize-telemetry-data">How to QA and summarize telemetry data</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview:</a></li>
  <li>
<a href="#caribou-data-set" id="toc-caribou-data-set" class="nav-link" data-scroll-target="#caribou-data-set">Caribou data set:</a>
  <ul class="collapse">
<li><a href="#reading-data-into-r." id="toc-reading-data-into-r." class="nav-link" data-scroll-target="#reading-data-into-r.">1. Reading data into R.</a></li>
  <li><a href="#clean-and-qa-the-data" id="toc-clean-and-qa-the-data" class="nav-link" data-scroll-target="#clean-and-qa-the-data">2. Clean and QA the data</a></li>
  <li><a href="#export-cleaned-data" id="toc-export-cleaned-data" class="nav-link" data-scroll-target="#export-cleaned-data">3. Export cleaned data</a></li>
  <li><a href="#generating-tabular-summaries" id="toc-generating-tabular-summaries" class="nav-link" data-scroll-target="#generating-tabular-summaries">4. Generating tabular summaries</a></li>
  <li><a href="#many-questions-we-can-ask-here" id="toc-many-questions-we-can-ask-here" class="nav-link" data-scroll-target="#many-questions-we-can-ask-here">Many questions we can ask here:</a></li>
  <li><a href="#standardize-fix-interval-times" id="toc-standardize-fix-interval-times" class="nav-link" data-scroll-target="#standardize-fix-interval-times">5. Standardize fix interval times</a></li>
  </ul>
</li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn">Your Turn</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ninoxconsulting/r-telemetry-workshop-nov-2023/edit/main/03-intro-telemetry-data.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/ninoxconsulting/r-telemetry-workshop-nov-2023/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Introduction to Telemetry Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="how-to-qa-and-summarize-telemetry-data" class="level2"><h2 class="anchored" data-anchor-id="how-to-qa-and-summarize-telemetry-data">How to QA and summarize telemetry data</h2>
</section><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview:</h2>
<p>In this module we will read in, clean, QA and summarize raw telemetry data. This includes:</p>
<ul>
<li><p>read in data as csv/xlsx and convert to spatial data</p></li>
<li><p>QA data for missing values and poor coordinate precision</p></li>
<li><p>generate tabular summaries</p></li>
<li><p>standardize fix rate of telemetry points for future analysis</p></li>
</ul></section><section id="caribou-data-set" class="level2"><h2 class="anchored" data-anchor-id="caribou-data-set">Caribou data set:</h2>
<p>In this workshop we will use GPS telemetry data from Mountain Caribou (<em>Rangifer terendus</em>) herds in the Peace region of British Columbia. The full data set and metadata can be found on <a href="https://www.movebank.org/cms/webapp?gwt_fragment=page=studies,path=study216040785">movebank</a>, also see <a href="./bonus-movebank.html">bonus content - How to download data from movebank</a>. The data set used in this course has been modified for demonstration purposes and should not be used in analysis.</p>
<section id="reading-data-into-r." class="level3"><h3 class="anchored" data-anchor-id="reading-data-into-r.">1. Reading data into R.</h3>
<p>In this course we will be providing two files (Mountain caribou in British Columbia-reference-data.csv and Mountain caribou.xlsx). The first task is to look at the data to make sense of what we have.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/read-in-raw-data_cefae122946e433be8ad05e860aedd7e">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># load libraries </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read in data files.</span></span>
<span><span class="va">ref_raw</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"raw_data/Mountain caribou in British Columbia-reference-data.csv"</span>, </span>
<span>                    name_repair <span class="op">=</span> <span class="st">"universal"</span><span class="op">)</span> <span class="co"># use this to standardise the column names</span></span>
<span></span>
<span><span class="va">loc_raw</span> <span class="op">&lt;-</span> <span class="fu">read_xlsx</span><span class="op">(</span><span class="st">"raw_data/Mountain caribou.xlsx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lets take a look….</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/review-raw-data_eb779dbfb1025f72c4148808711138af">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reference data </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ref_raw</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 26
  tag.id  animal.id  animal.taxon      deploy.on.date deploy.off.date
  &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;             &lt;time&gt;         &lt;time&gt;         
1 151.51  HR_151.510 Rangifer tarandus    NA             NA          
2 C04a    GR_C04     Rangifer tarandus    NA          59:00          
3 C03     GR_C03     Rangifer tarandus    NA             NA          
4 151.805 HR_151.805 Rangifer tarandus    NA             NA          
5 151.76  HR_151.760 Rangifer tarandus    NA             NA          
6 151.72  HR_151.720 Rangifer tarandus    NA             NA          
# ℹ 21 more variables: animal.death.comments &lt;chr&gt;, animal.life.stage &lt;chr&gt;,
#   animal.reproductive.condition &lt;chr&gt;, animal.sex &lt;chr&gt;,
#   animal.taxon.detail &lt;chr&gt;, attachment.type &lt;chr&gt;,
#   deploy.off.latitude &lt;dbl&gt;, deploy.off.longitude &lt;dbl&gt;,
#   deploy.on.latitude &lt;dbl&gt;, deploy.on.longitude &lt;dbl&gt;,
#   deploy.on.person &lt;chr&gt;, deployment.comments &lt;chr&gt;,
#   deployment.end.comments &lt;chr&gt;, deployment.end.type &lt;chr&gt;, …</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ref_raw</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "tag.id"                        "animal.id"                    
 [3] "animal.taxon"                  "deploy.on.date"               
 [5] "deploy.off.date"               "animal.death.comments"        
 [7] "animal.life.stage"             "animal.reproductive.condition"
 [9] "animal.sex"                    "animal.taxon.detail"          
[11] "attachment.type"               "deploy.off.latitude"          
[13] "deploy.off.longitude"          "deploy.on.latitude"           
[15] "deploy.on.longitude"           "deploy.on.person"             
[17] "deployment.comments"           "deployment.end.comments"      
[19] "deployment.end.type"           "deployment.id"                
[21] "manipulation.type"             "study.site"                   
[23] "tag.beacon.frequency"          "tag.manufacturer.name"        
[25] "tag.model"                     "tag.serial.no"                </code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ref_short</span> <span class="op">&lt;-</span> <span class="va">ref_raw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">tag.id</span>, <span class="va">animal.id</span>, <span class="va">deploy.on.date</span>, <span class="va">animal.sex</span>, <span class="va">animal.reproductive.condition</span>,</span>
<span>         <span class="va">deployment.end.type</span>,<span class="va">tag.model</span>, <span class="va">tag.manufacturer.name</span>, <span class="va">tag.serial.no</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Location data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">loc_raw</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
    event.id timestamp location.long location.lat   DOP FixType     herd 
       &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;
1 2270202009 01:00.0           -124.         55.9     1 val. GPS-3D Scott
2 2270202041 01:00.0           -124.         55.9     1 val. GPS-3D Scott
3 2270202100 01:00.0           -124.         55.9     1 val. GPS-3D Scott
4 2270202901 01:00.0           -123.         55.8     1 val. GPS-3D Scott
5 2270202132 01:00.0           -123.         55.9     1 val. GPS-3D Scott
6 2270202890 01:00.0           -123.         55.9     1 val. GPS-3D Scott
# ℹ 7 more variables: study.specific.measurement &lt;chr&gt;, sensor.type &lt;chr&gt;,
#   individual.taxon.canonical.name &lt;chr&gt;, tag.local.identifier &lt;chr&gt;,
#   individual.local.identifier &lt;chr&gt;, study.name &lt;chr&gt;, date &lt;chr&gt;</code></pre>
</div>
</div>
<p>We can combine these data sets and keep the columns of interest</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/filter-raw-fields_b074ca87db0ad983bbb92974957db0d5">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a new data set by joining on a common field</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">loc_raw</span>, <span class="va">ref_raw</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'tag.local.identifier'</span> <span class="op">=</span> <span class="st">'tag.id'</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># filter the columns of interest</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">event.id</span>, <span class="va">location.long</span>, <span class="va">location.lat</span>, <span class="va">DOP</span>, <span class="va">FixType</span>, <span class="va">herd</span>,</span>
<span>         <span class="va">study.specific.measurement</span>, <span class="va">sensor.type</span>, <span class="va">tag.local.identifier</span>, <span class="va">date</span>, <span class="va">animal.id</span>,</span>
<span>         <span class="va">animal.sex</span>, <span class="va">animal.reproductive.condition</span>, <span class="va">tag.manufacturer.name</span>, <span class="va">tag.model</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="clean-and-qa-the-data" class="level3"><h3 class="anchored" data-anchor-id="clean-and-qa-the-data">2. Clean and QA the data</h3>
<section id="a.-data-input-errors-and-column-formats" class="level4"><h4 class="anchored" data-anchor-id="a.-data-input-errors-and-column-formats">2a. Data input errors and column formats</h4>
<p>Lets check for NA or missing values.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/remove-NA-values_4e79e56ad9c6e7e4dcf8a4709b49df27">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  event.id location.long location.lat   DOP FixType herd  study.specific.measu…¹
     &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                 
1   2.27e9         -124.         55.9     1 val. G… Scott Summer                
2   2.27e9         -124.         55.9     1 val. G… Scott Summer                
3   2.27e9         -124.         55.9     1 val. G… Scott Summer                
4   2.27e9         -123.         55.8     1 val. G… Scott Summer                
5   2.27e9         -123.         55.9     1 val. G… Scott Winter                
6   2.27e9         -123.         55.9     1 val. G… Scott Summer                
# ℹ abbreviated name: ¹​study.specific.measurement
# ℹ 8 more variables: sensor.type &lt;chr&gt;, tag.local.identifier &lt;chr&gt;,
#   date &lt;chr&gt;, animal.id &lt;chr&gt;, animal.sex &lt;chr&gt;,
#   animal.reproductive.condition &lt;chr&gt;, tag.manufacturer.name &lt;chr&gt;,
#   tag.model &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check if there are NA's in the data </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">all_data</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     event.id                 location.long 
                        FALSE                          TRUE 
                 location.lat                           DOP 
                         TRUE                         FALSE 
                      FixType                          herd 
                        FALSE                          TRUE 
   study.specific.measurement                   sensor.type 
                         TRUE                         FALSE 
         tag.local.identifier                          date 
                        FALSE                         FALSE 
                    animal.id                    animal.sex 
                        FALSE                         FALSE 
animal.reproductive.condition         tag.manufacturer.name 
                         TRUE                         FALSE 
                    tag.model 
                        FALSE </code></pre>
</div>
</div>
<p>Several columns contain NA’s and need more exploration.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/remove-NA-values2_acb5307f85a93eb7fceafc24a6b3e678">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># filter missing values for latitude, longitude and date.</span></span>
<span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># keep any rows which are not NA</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">location.long</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">location.lat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Herd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">herd</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Scott"      "Burnt Pine" NA          </code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># two missing herd values which we can fill in (or delete)</span></span>
<span></span>
<span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">tdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>herd <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">animal.id</span> <span class="op">==</span> <span class="st">"BP_car043"</span> <span class="op">~</span> <span class="st">"Burnt Pine"</span>, </span>
<span>    <span class="va">animal.id</span> <span class="op">==</span> <span class="st">"SC_car170"</span> <span class="op">~</span> <span class="st">"Scott"</span>,</span>
<span>    .default <span class="op">=</span> <span class="va">herd</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## rerun the NA check to confirm </span></span>
<span></span>
<span><span class="co"># apply(tdata, 2, function(x) any(is.na(x)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="b.-dealing-with-date-times" class="level4"><h4 class="anchored" data-anchor-id="b.-dealing-with-date-times">2b. Dealing with date-times</h4>
<p>Timestamps can be confusing and problematic, especially when working with multiple programs and file types. One solution is to split the date into separate components (year, month, day, time).</p>
<p>We firstly need to format the raw data into a date format using <strong>lubridate</strong> package.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/convert-time-stamp_142ab9e36a7993ac2a8c381dd0ca8597">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate time differences</span></span>
<span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">tdata</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date_time <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `date_time = ymd_hms(date)`.
Caused by warning:
!  5 failed to parse.</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># owch we still have an error in this data set</span></span>
<span></span>
<span><span class="co"># lets see if we can find it..... </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2003-12-12 13:03:29.000" "2003-12-13 09:03:10.000"
[3] "2003-12-14 05:03:11.000" "2003-12-15 01:03:10.000"
[5] "2003-12-15 21:04:00.000" "2003-12-16 17:03:10.000"</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2016-03-16 10:01:00.000" "2016-03-16 17:49:00.000"
[3] "2016-03-16 19:49:00.000" "2016-03-17 17:53:00.000"
[5] "2016-03-17 19:53:00.000" "NA"                     </code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Note this is not the same format as an NA we searched for above. i.e. "NA" is not equal to NA. </span></span>
<span></span>
<span><span class="co"># lets remove the NA </span></span>
<span></span>
<span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">tdata</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">!=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># re-run the code to convert to a date format. </span></span>
<span></span>
<span><span class="va">tdata</span>  <span class="op">&lt;-</span> <span class="va">tdata</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date_time <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># lets take a look </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">date_time</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2013-09-23 10:01:00 UTC" "2013-10-09 10:01:00 UTC"
[3] "2013-10-30 10:01:00 UTC" "2014-08-11 10:01:00 UTC"
[5] "2013-11-10 02:01:00 UTC" "2014-08-07 10:01:00 UTC"</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Note the Universal Coordinated Time Zone</span></span>
<span></span>
<span></span>
<span><span class="co"># lets split this data format into something more useful </span></span>
<span></span>
<span><span class="va">tdata</span>  <span class="op">&lt;-</span> <span class="va">tdata</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date_time</span> <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date_time</span> <span class="op">)</span>,</span>
<span>         day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span>,</span>
<span>         hour <span class="op">=</span> <span class="fu">hour</span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span>,</span>
<span>         minute <span class="op">=</span> <span class="fu">minute</span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="c.-spatial-accuracy-qa." class="level4"><h4 class="anchored" data-anchor-id="c.-spatial-accuracy-qa.">2c. Spatial accuracy QA.</h4>
<p>Next we will review the spatial accuracy of the point data. We have two columns which contain accuracy metrics: DOP (Dilution of Precision), and Fix Type.</p>
<p>Note: For quick review of spatial errors it is helpful to view the data in QGIS or built a quick map or vizualisation (this is covered later in the <a href="./04-spatial-data-viz.html">workshop</a>).</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/clean-lat-longs_2bec30f76001706d76f3d332de299952">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># review Latitudes and Longitude values </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">location.lat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  55.2249 155.4764</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">location.lat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/clean-lat-longs-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Note some points are above 65 Latitude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">location.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -123.6684  -22.0000</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">location.long</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/clean-lat-longs-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Lets set an upper limit and filter values which are within the range we want.</span></span>
<span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">tdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">location.long</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">location.lat</span> <span class="op">&lt;=</span> <span class="fl">65</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="d.-spatial-precision-qa." class="level4"><h4 class="anchored" data-anchor-id="d.-spatial-precision-qa.">2d. Spatial Precision QA.</h4>
<p>To refine the level of precision we can use the metrics DOP (Dilution of Precision) and Fixtype information which is associated with each location observation.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/DOP-review_f4a2d62799130bad78324bc32b856479">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span> <span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">DOP</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0 43.1</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">tdata</span><span class="op">$</span><span class="va">DOP</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/DOP-review-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># We only want to keep fixes with a DOP less than 10m</span></span>
<span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="va">tdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">DOP</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Fixtype is generally classified into categories, based on the level of precision of the calculated location i.e.&nbsp;the number of satellite used to triangulate the fixes. These metrics will vary with the device type and model. More information will be available through the manufacturer website (For example: <a href="https://www.lotek.com/products/litetrack-iridium-250-750">Lotek Iridium collars</a> ).</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/fixtype-review_58a207762a44b4c016f05703255632fd">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check the number of records per fix type</span></span>
<span><span class="va">fdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">FixType</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  FixType     count
  &lt;chr&gt;       &lt;int&gt;
1 GPS-2D         92
2 GPS-3D        291
3 val. GPS-3D 16801</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># We will only keep the higher level of precision</span></span>
<span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="va">fdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">FixType</span> <span class="op">!=</span> <span class="st">"GPS-2D"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see what the data looks like</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">fdata</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 17,092
Columns: 21
$ event.id                      &lt;dbl&gt; 2270202009, 2270202041, 2270202100, 2270…
$ location.long                 &lt;dbl&gt; -123.6036, -123.5987, -123.5903, -123.49…
$ location.lat                  &lt;dbl&gt; 55.90000, 55.87343, 55.87470, 55.83741, …
$ DOP                           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ FixType                       &lt;chr&gt; "val. GPS-3D", "val. GPS-3D", "val. GPS-…
$ herd                          &lt;chr&gt; "Scott", "Scott", "Scott", "Scott", "Sco…
$ study.specific.measurement    &lt;chr&gt; "Summer", "Summer", "Summer", "Summer", …
$ sensor.type                   &lt;chr&gt; "gps", "gps", "gps", "gps", "gps", "gps"…
$ tag.local.identifier          &lt;chr&gt; "car170", "car170", "car170", "car170", …
$ date                          &lt;chr&gt; "2013-09-23 10:01:00.000", "2013-10-09 1…
$ animal.id                     &lt;chr&gt; "SC_car170", "SC_car170", "SC_car170", "…
$ animal.sex                    &lt;chr&gt; "f", "f", "f", "f", "f", "f", "f", "f", …
$ animal.reproductive.condition &lt;chr&gt; "with calf: N", "with calf: N", "with ca…
$ tag.manufacturer.name         &lt;chr&gt; "ATS", "ATS", "ATS", "ATS", "ATS", "ATS"…
$ tag.model                     &lt;chr&gt; "GPS Iridium", "GPS Iridium", "GPS Iridi…
$ date_time                     &lt;dttm&gt; 2013-09-23 10:01:00, 2013-10-09 10:01:0…
$ year                          &lt;dbl&gt; 2013, 2013, 2013, 2014, 2013, 2014, 2014…
$ month                         &lt;dbl&gt; 9, 10, 10, 8, 11, 8, 9, 12, 7, 11, 6, 12…
$ day                           &lt;int&gt; 23, 9, 30, 11, 10, 7, 19, 6, 8, 24, 20, …
$ hour                          &lt;int&gt; 10, 10, 10, 10, 2, 10, 2, 18, 18, 2, 2, …
$ minute                        &lt;int&gt; 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 0, 0, 1…</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lets check if this column is any use? </span></span>
<span><span class="co"># unique(fdata$sensor.type)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The final step is to remove redundant columns.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/remove-unused-cols_35c5264c548e4af82f4703315b284614">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="va">fdata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">FixType</span>, <span class="op">-</span><span class="va">DOP</span>, <span class="op">-</span><span class="va">date</span>, <span class="op">-</span><span class="va">study.specific.measurement</span>, <span class="op">-</span><span class="va">sensor.type</span>, <span class="op">-</span><span class="va">event.id</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="export-cleaned-data" class="level3"><h3 class="anchored" data-anchor-id="export-cleaned-data">3. Export cleaned data</h3>
<section id="a.-export-as-a-table" class="level4"><h4 class="anchored" data-anchor-id="a.-export-as-a-table">3a. Export as a table</h4>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/write-csv_d57748dd3c5bfa4084ba7b59afcb756a">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">fdata</span>, <span class="st">"clean_data/caribou.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="b.-convert-to-spatial-file-and-export" class="level4"><h4 class="anchored" data-anchor-id="b.-convert-to-spatial-file-and-export">3b. Convert to spatial file and export</h4>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/write-out_5b99bdf092df9bc6675db77846f4863c">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># convert to a sf object and transform to BC Albers</span></span>
<span><span class="va">bou</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">fdata</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location.long"</span>, <span class="st">"location.lat"</span><span class="op">)</span>, </span>
<span>                crs <span class="op">=</span> <span class="fl">4326</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">st_transform</span><span class="op">(</span><span class="fl">3005</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>export as .gpkg</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-1_834185486cb322a3b2cd41ee238eb697">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_sf</span><span class="op">(</span><span class="va">bou</span>, <span class="st">"clean_data/caribou.gpkg"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also export to a .shp file</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-2_94da9c28b52bdf377f41792c37c9f916">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_sf</span><span class="op">(</span><span class="va">bou</span>, <span class="st">"clean_data/caribou.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># note warning on names for shapefile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="generating-tabular-summaries" class="level3"><h3 class="anchored" data-anchor-id="generating-tabular-summaries">4. Generating tabular summaries</h3>
<p>Now we have clean data to work with we can get to the fun data exploration part!</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/read-in-geopackage_b71821121ccf9f526c527a2f757c3b68">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bou</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"clean_data/caribou.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#or </span></span>
<span></span>
<span><span class="va">bou_sf</span> <span class="op">=</span> <span class="fu">read_sf</span><span class="op">(</span><span class="st">"clean_data/caribou.gpkg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bou</span> <span class="op">&lt;-</span> <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="va">bou_sf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="many-questions-we-can-ask-here" class="level3"><h3 class="anchored" data-anchor-id="many-questions-we-can-ask-here">Many questions we can ask here:</h3>
<ul>
<li>how many herds do we have?</li>
<li>how many animals in each herd?</li>
<li>what is the sex ratio of collared animals?</li>
<li>what is the duration of each collar? Start and end years?</li>
</ul>
<p>Lets start with the basics:</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/summarise-clean-data_2289a963de91897ca1a1edfe98089d1b">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># how many herds?</span></span>
<span><span class="va">no_herds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bou</span><span class="op">$</span><span class="va">herd</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#How many records per herd ?</span></span>
<span><span class="va">no_records</span> <span class="op">&lt;-</span> <span class="va">bou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">herd</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># number of animal records per herd?</span></span>
<span><span class="va">no_animals_id</span> <span class="op">&lt;-</span> <span class="va">bou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">herd</span>, <span class="va">animal.id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'herd'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># animals by sex by herd ?</span></span>
<span><span class="va">no_animals_sex</span> <span class="op">&lt;-</span> <span class="va">bou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">herd</span>, <span class="va">animal.sex</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'herd'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># type of collar by herd by collar model?</span></span>
<span><span class="va">collar_type</span> <span class="op">&lt;-</span> <span class="va">bou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">herd</span>, <span class="va">tag.manufacturer.name</span>, <span class="va">tag.model</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'herd', 'tag.manufacturer.name'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<p>There is lots of data here, so to make it easy we will just use the Scott herd.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/summarise-scott-herd_0f48c3ca4e3e0bb9ea0461a9eeae4031">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Filter the Scott herd only </span></span>
<span><span class="va">sbou</span> <span class="op">&lt;-</span> <span class="va">bou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">herd</span> <span class="op">==</span> <span class="st">"Scott"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tidy the data by removing columns that are redundant</span></span>
<span><span class="va">sbou</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">herd</span>, <span class="op">-</span><span class="va">tag.local.identifier</span>, <span class="op">-</span><span class="va">tag.manufacturer.name</span>, <span class="op">-</span><span class="va">tag.model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># how many animals?</span></span>
<span><span class="va">no_sbou</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">sbou</span><span class="op">$</span><span class="va">animal.id</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="question-what-is-the-spread-of-fixes-per-season" class="level4"><h4 class="anchored" data-anchor-id="question-what-is-the-spread-of-fixes-per-season">Question: What is the spread of fixes per season?</h4>
<p>Next we format the date variable so we can filter by months and years. We can also assign fixes to seasons based on the following dates :</p>
<ul>
<li>Spring/calving (April,May)</li>
<li>Summer (June to August)</li>
<li>Fall (September to November)</li>
<li>Winter (December to March)</li>
</ul>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/add-seasons_404965b37e2608fd140cd13ce923c10d">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sbou</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>season <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>            <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="st">"spring"</span>,</span>
<span>            <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span> <span class="op">~</span> <span class="st">"summer"</span>,</span>
<span>            <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span> <span class="op">~</span> <span class="st">"fall"</span>,</span>
<span>            <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="st">"winter"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="co"># check data spread</span></span>
<span><span class="va">counts.per.season</span> <span class="op">=</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">season</span>, <span class="va">animal.id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'season'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">counts.per.season</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">season</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">animal.id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"season"</span>, y <span class="op">=</span> <span class="st">"no.of.fixes"</span>, title <span class="op">=</span> <span class="st">"Scott Herd"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/add-seasons-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Then we can save our plot</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-3_42213f0c59e291260cafd5120167744e">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"caribou_fixes_per_id.jpeg"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="question-what-is-the-duration-of-the-collar-data" class="level4"><h4 class="anchored" data-anchor-id="question-what-is-the-duration-of-the-collar-data">Question: What is the duration of the collar data ?</h4>
<p>The duration of the collars is also an important question. These can tell us not only the first and last fix, but also point to potential errors or issues we need to consider for future analysis.</p>
<p>Lets calculate the minimum, maximum and duration between fix times.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/collar-duration_7616dbece32857531e3a6db315b8134d">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># which years were the collars active?</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sbou</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">year</span>, fill <span class="op">=</span> <span class="va">animal.id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/collar-duration-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate the minimum and max dates per collar </span></span>
<span><span class="va">table_max</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">date_time</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># select the columns of interest</span></span>
<span>  <span class="fu">slice_max</span><span class="op">(</span><span class="va">date_time</span>, by <span class="op">=</span> <span class="va">animal.id</span><span class="op">)</span>  <span class="co"># select the max value of date_time, per animal.id</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">table_max</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"animal.id"</span>,<span class="st">"max"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_min</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">date_time</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">slice_min</span><span class="op">(</span><span class="va">date_time</span>, by <span class="op">=</span> <span class="va">animal.id</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">table_min</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"animal.id"</span>,<span class="st">"min"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># merge the two tables together and calculate the duration </span></span>
<span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">table_max</span>, <span class="va">table_min</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration <span class="op">=</span> <span class="va">max</span> <span class="op">-</span> <span class="va">min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># calculate duration (default is days)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>dur_days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="va">duration</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># format the duration </span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>dur_hrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dur_days</span><span class="op">)</span><span class="op">*</span><span class="fl">24</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># convert to hours</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year_start <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">min</span><span class="op">)</span>, </span>
<span>         year_end <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">max</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot total duration of collar data </span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dur</span>, <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">min</span>, xend<span class="op">=</span><span class="va">max</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span>, yend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Tag"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/collar-duration-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sbou</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">animal.id</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/collar-duration-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="standardize-fix-interval-times" class="level3"><h3 class="anchored" data-anchor-id="standardize-fix-interval-times">5. Standardize fix interval times</h3>
<p>Another data processing method we might need to consider is having a standard density or fix rate for all animals. This may not be required, depending on the research question being asked, but it is useful to assess measures of density.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/check-fix-per-day_0e66de18d732391e4c57d13df3b39968">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sbou</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">date_time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sbou_dur</span> <span class="op">&lt;-</span> <span class="va">sbou</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">date_time</span>, format <span class="op">=</span> <span class="st">"%y/%d/%m %H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">time</span>, <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hours"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we can see a big range in the time intervals for the fixes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">sbou_dur</span><span class="op">$</span><span class="va">diff</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   0.01666667 111.75000000</code></pre>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># most fall in the less than than 10 </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">sbou_dur</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/check-fix-per-day-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lets look at the individual animals</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sbou_dur</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">animal.id</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/check-fix-per-day-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># much of the problem is with the SC_car171 individual </span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sbou_dur</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">diff</span>, x <span class="op">=</span> <span class="va">date_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">animal.id</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/check-fix-per-day-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The number of fixes are relatively steady throughout the years for all individuals except SC_car171? Something looks strange here as there are large spikes in October 2015 and February 2016. Potential mortality signals?</p>
<p>To create a standardized fix per day, lets take the first fix per day. This could be based on a number of factors, depending on our research question we want to ask. We can use Julian date to filter all fixes.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-4_9d1fafcc6ed2f31e5c0483e4a05c51a9">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># we can subset base on a Julian date</span></span>
<span><span class="va">sbou_dur</span> <span class="op">&lt;-</span> <span class="va">sbou_dur</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    date2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">date_time</span>, format <span class="op">=</span> <span class="st">'%Y-%m-%d'</span><span class="op">)</span>, <span class="co"># convert to date type</span></span>
<span>    jdate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">julian</a></span><span class="op">(</span><span class="va">date2</span><span class="op">)</span>               <span class="co"># create new column and calculate Julian date </span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the multiple counts of animals per day </span></span>
<span><span class="va">counts.per.day.jdate</span> <span class="op">&lt;-</span> <span class="va">sbou_dur</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">jdate</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, unique <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">jdate</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">total</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>total.j <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'animal.id', 'jdate'. You can override
using the `.groups` argument.
`summarise()` has grouped output by 'animal.id', 'total'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lets plot this data to make more sense of what is happening</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">counts.per.day.jdate</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">total</span>, y <span class="op">=</span> <span class="va">total.j</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">animal.id</span> <span class="op">+</span> <span class="va">year</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lets select the first fix per day </span></span>
<span><span class="va">sbou_sub</span> <span class="op">&lt;-</span> <span class="va">sbou_dur</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.id</span>, <span class="va">jdate</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">slice_sample</span><span class="op">(</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can write out the standardized fix rate file for future use in analysis.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/write-standard-subset-csv_20a1184273ce25fe91d11df42de136ef">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lets write this out as .csv and .Gpkg</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">sbou_sub</span>, <span class="st">"clean_data/scott_herd_subset.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively we can convert to a sf object and export. Note this is required as we previously remove the spatial components to undertake the summaries above.</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/write-standard-subset-gpk_75f45d2295e23f2dbcded3df0b93f902">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sbou_sub_sf</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">sbou_sub</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location.long"</span>, <span class="st">"location.lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">st_transform</span><span class="op">(</span><span class="fl">3005</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Export as .gpkg</p>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-5_42f74571853b33f1e740c0a2193d8dc4">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># # export as .gpkg</span></span>
<span><span class="fu">write_sf</span><span class="op">(</span><span class="va">sbou_sub_sf</span>, <span class="st">"clean_data/scott_herd_subset.gpkg"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-6_e78bc9a8d99341de00f2cc612601a20f">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot months of the year. </span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sbou</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">animal.id</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-intro-telemetry-data_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="your-turn" class="level2"><h2 class="anchored" data-anchor-id="your-turn">Your Turn</h2>
<ol type="1">
<li>Use the Burnt Pine herd to answer the following questions:</li>
</ol>
<ul>
<li>how many animals in this herd?</li>
<li>how many records are in this herd per animal?</li>
<li>what is the sex ratio of collared animals?</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-hash="03-intro-telemetry-data_cache/html/unnamed-chunk-7_2e5c8dd9d28a245b513dc150476c1acc">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bou_sf</span> <span class="op">=</span> <span class="fu">read_sf</span><span class="op">(</span><span class="st">"clean_data/caribou.gpkg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="va">bou_sf</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">herd</span> <span class="op">==</span> <span class="st">"Burnt Pine"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_animals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bp</span><span class="op">$</span><span class="va">animal.id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_records_per_animal</span> <span class="op">&lt;-</span> <span class="va">bp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_animals_sex</span> <span class="op">&lt;-</span> <span class="va">bp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">animal.sex</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>